import"https://cdnjs.cloudflare.com/ajax/libs/js-yaml/4.1.0/js-yaml.min.js";(function(){const n=document.createElement("link").relList;if(n&&n.supports&&n.supports("modulepreload"))return;for(const t of document.querySelectorAll('link[rel="modulepreload"]'))s(t);new MutationObserver(t=>{for(const o of t)if(o.type==="childList")for(const a of o.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&s(a)}).observe(document,{childList:!0,subtree:!0});function r(t){const o={};return t.integrity&&(o.integrity=t.integrity),t.referrerPolicy&&(o.referrerPolicy=t.referrerPolicy),t.crossOrigin==="use-credentials"?o.credentials="include":t.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function s(t){if(t.ep)return;t.ep=!0;const o=r(t);fetch(t.href,o)}})();const L="modulepreload",A=function(e){return"/"+e},g={},R=function(n,r,s){if(!r||r.length===0)return n();const t=document.getElementsByTagName("link");return Promise.all(r.map(o=>{if(o=A(o),o in g)return;g[o]=!0;const a=o.endsWith(".css"),u=a?'[rel="stylesheet"]':"";if(!!s)for(let i=t.length-1;i>=0;i--){const l=t[i];if(l.href===o&&(!a||l.rel==="stylesheet"))return}else if(document.querySelector(`link[href="${o}"]${u}`))return;const c=document.createElement("link");if(c.rel=a?"stylesheet":L,a||(c.as="script",c.crossOrigin=""),c.href=o,document.head.appendChild(c),a)return new Promise((i,l)=>{c.addEventListener("load",i),c.addEventListener("error",()=>l(new Error(`Unable to preload CSS for ${o}`)))})})).then(()=>n())},E=Object.freeze({openlayers:"./BasicOpenlayersRenderer.js",leaflet:"./BasicLeafletRenderer.js",maplibre:"./BasicMaplibreRenderer.js"});function x(e){return new Promise(function(n,r){if(e.endsWith(".js")){let s=document.createElement("script");Object.assign(s,{src:e,async:!1,onload:function(){n(e)},onerror:function(){r(e)}}),document.head.appendChild(s)}else if(e.endsWith(".css")){let s=document.createElement("link");Object.assign(s,{rel:"stylesheet",href:e,onload:function(){n(e)},onerror:function(){r(e)}}),document.head.appendChild(s)}})}const m=Array.from(document.querySelectorAll("script")).find(e=>e.src==import.meta.url),O=m.parentElement;let y=m.dataset.to;y??(y=".map");const d=Array.from(O.querySelectorAll(y));let S=m.dataset.from;S??(S=y);const j=Array.from(O.querySelectorAll(S)),w=new Set;function p(e){let n=e.replace(/^\s*\n+/,"");const r=n.split(/\n\s*\n/);n=r[0];const s=r.length>1?r.slice(1).join(`

`):void 0,t=jsyaml.load(n)??{};return s&&(t.eval=s),t}async function C(){return Promise.all(j.map(async(e,n)=>{let r=p(e.value??e.textContent);if(r.hasOwnProperty("preset"))if(n!=0&&r.preset=="last"){let s=d[n-1].config;Object.setPrototypeOf(r,s)}else{const t=await(await fetch(r.preset)).text(),o=p(t);o.eval&&(r.eval=o.eval+`
`+r.eval),r=Object.assign({},o,r)}r.use||(r.use=Object.keys(E)[0]),d[n].config=r,w.add(r.use)}))}async function b(){await C();for(let e of w){let n=new(await R(()=>import(E[e]),[])).default,r=d.filter(t=>t.config.use==e);if(r.forEach(t=>{Object.setPrototypeOf(t.config,n.defaultConfig),n.handleAliases(t.config),n.appendResources(t.config)}),r.length>0)window.renderer=n;else continue;let s=[];n.resources.forEach(t=>{s.push(x(t))}),Promise.all(s).then(function(){r.forEach(t=>{n.renderMap(t),t.dispatchEvent(new Event("map-rendered"))})}).catch(function(t){console.log(t+" failed to load")})}}b();window.refreshMap=b;window.loadOptions=p;const N=document.querySelector("#map"),h=document.querySelector("#map-text"),_=document.querySelectorAll("fieldset");N.addEventListener("map-loaded",()=>{v(!1)});h.addEventListener("focusout",e=>{v(k())});const $=document.querySelectorAll('div[class="field"]');$.forEach(e=>{e.addEventListener("click",n=>{e.querySelector('input[type="radio"]').checked=!0;const r=e.querySelector('input[type="text"]');r&&r.focus&&r.focus();const s=e.querySelector("input").name;var t=e.dataset.value;switch(t||(t=r?r.value:""),e.parentElement.dataset.type){case"boolean":t=t==="true";break;case"array":t=JSON.parse(t);break;case"number":t=Number.parseFloat(t);break}var o={};s.split(".").reverse().forEach((f,c)=>{o={[f]:c==0?t:o}});var a=P();Object.assign(a,o),q(a);const u=jsyaml.dump(a);h.value=u.startsWith("{}")?"":u,v(k())})});const B=document.querySelectorAll('input[type="text"]');B.forEach(e=>{e.addEventListener("focusout",n=>{e.parentElement.click()})});function q(e){for(let n in e)typeof e[n]=="object"&&e[n]!==null?(q(e[n]),Object.keys(e[n]).length===0&&delete e[n]):e[n]===""&&delete e[n]}function k(){const e=document.querySelector(".auto-refresh");return e?e.checked:!1}async function v(e){e&&await refreshMap();const n=P();_.forEach(r=>{const s=r.querySelector("legend").textContent;renderer.supportOptions.includes(s)?r.style.display="block":r.style.display="none";function t(u,f){const c=u.split(".");let i=f;for(let l of c)if(i.hasOwnProperty(l))i=i[l];else return"";return i}var o=t(s,n);r.dataset.type=="array"&&(o=`[${o.toString()}]`);var a=r.querySelector(`div.field[data-value="${o}"]`);a=a||r.querySelector('div.field[data-value=""]'),a.querySelector('input[type="radio"]').checked=!0})}function P(){var e=loadOptions(h.value);return e||{}}
